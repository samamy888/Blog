import{_ as e,r as p,o,c,a as n,b as t,d as s,e as l}from"./app.538b8145.js";const i={},u=n("h1",{id:"\u5728-net-core-6-\u7684-console-app-\u4E0A-di-\u6CE8\u5165-nlog",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5728-net-core-6-\u7684-console-app-\u4E0A-di-\u6CE8\u5165-nlog","aria-hidden":"true"},"#"),s(" \u5728.net core 6 \u7684 console app \u4E0A DI \u6CE8\u5165 NLog")],-1),r={href:"https://github.com/NLog/NLog.Extensions.Logging/wiki/NLog-configuration-with-appsettings.json",target:"_blank",rel:"noopener noreferrer"},k=s("\u5B98\u65B9wiki"),d=s("\u4E0A\u4E5F\u6C92\u6709\u6559\u600E\u9EBC\u628ANLog\u4F7F\u7528DI\u65B9\u5F0F\u6CE8\u9032\u53BB"),v=n("p",null,"\u722C\u6587\u767C\u73FE\u6709\u4EBA\u5BE6\u4F5C\u4E86\uFF0C\u5C31\u4F86\u8A18\u9304\u4E00\u4E0B\u81EA\u5DF1\u7684\u7248\u672C\u3002 \u958B\u767C\u7248\u672C\u662F .net 6",-1),g=n("h2",{id:"_1-nuget-\u5B89\u88DD\u5957\u4EF6",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1-nuget-\u5B89\u88DD\u5957\u4EF6","aria-hidden":"true"},"#"),s(" 1. NuGet \u5B89\u88DD\u5957\u4EF6")],-1),m=n("ul",null,[n("li",null,"NLog"),n("li",null,"NLog.Extensions.Logging")],-1),b=n("h2",{id:"_2-\u5275\u5EFAnlog-config",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_2-\u5275\u5EFAnlog-config","aria-hidden":"true"},"#"),s(" 2. \u5275\u5EFANLog.config")],-1),h=n("p",null,"\u5275\u5EFA\u5728\u6839\u76EE\u9304\u4E0A\uFF0C",-1),_=s("\u76F8\u95DCconfig\u8A2D\u5B9A\u53EF\u4EE5\u53C3\u8003\u5B98\u65B9wiki "),f={href:"https://github.com/NLog/NLog/wiki/Configuration-file",target:"_blank",rel:"noopener noreferrer"},q=s("Configuration file"),L=l(`<div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nlog</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.nlog-project.org/schemas/NLog.xsd<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NLog NLog.xsd<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">autoReload</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">throwExceptions</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">internalLogLevel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Off<span class="token punctuation">&quot;</span></span> <span class="token attr-name">internalLogFile</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NLog\\all_log.log<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>targets</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--\u6A94\u6848\u65E5\u8A8C\uFF0Carchive\u76F8\u95DC\u5F15\u6578\uFF1A\u6A94\u6848\u62C6\u5206\uFF0C\u6BCF100M\u62C6\u5206\u4E00\u500B\u65B0\u6A94\u6848--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span> <span class="token attr-name"><span class="token namespace">xsi:</span>type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>File<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>all_log<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NLog\\\${shortdate}\\\${uppercase:\${level}}.log<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>\${longdate}|\${logger}|\${uppercase:\${level}}|\${message} \${exception}<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">archiveFileName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NLog\\\${shortdate}\\\${uppercase:\${level}}\${shortdate}.{####}.log<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">archiveNumbering</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Rolling<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">archiveAboveSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10485760<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">concurrentwrites</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">maxArchiveFiles</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span>
              <span class="token punctuation">/&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>targets</span><span class="token punctuation">&gt;</span></span>


  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rules</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- add your logging rules here --&gt;</span>
    <span class="token comment">&lt;!--\u8DEF\u7531\u9806\u5E8F\u6703\u5C0D\u65E5\u8A8C\u5217\u5370\u7522\u751F\u5F71\u97FF\u3002\u8DEF\u7531\u5339\u914D\u908F\u8F2F\u70BA\u9806\u5E8F\u5339\u914D\u3002--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span> <span class="token attr-name">minlevel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Information<span class="token punctuation">&quot;</span></span> <span class="token attr-name">writeTo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>all_log<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rules</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nlog</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-program-cs-\u90E8\u5206" tabindex="-1"><a class="header-anchor" href="#_3-program-cs-\u90E8\u5206" aria-hidden="true">#</a> 3. Program.cs \u90E8\u5206</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">DotNetCoreNLogDI</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">NLog<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Logging</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// build config</span>
    <span class="token class-name">IConfiguration</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ConfigurationBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">SetBasePath</span><span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">GetCurrentDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">AddJsonFile</span><span class="token punctuation">(</span><span class="token string">&quot;appsettings.json&quot;</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">optional</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">reloadOnChange</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// configure logging</span>
    services<span class="token punctuation">.</span><span class="token function">AddLogging</span><span class="token punctuation">(</span>builder <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        builder<span class="token punctuation">.</span><span class="token function">ClearProviders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">AddConsole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">AddDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        builder<span class="token punctuation">.</span><span class="token function">AddNLog</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span><span class="token function">GetSection</span><span class="token punctuation">(</span><span class="token string">&quot;NLog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// add app</span>
    services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddTransient</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>App<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name"><span class="token keyword">var</span></span> services <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">ServiceCollection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ConfigureServices</span><span class="token punctuation">(</span>services<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">using</span> <span class="token class-name"><span class="token keyword">var</span></span> serviceProvider <span class="token operator">=</span> services<span class="token punctuation">.</span><span class="token function">BuildServiceProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// entry to run app</span>
<span class="token keyword">await</span> serviceProvider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetService</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>App<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-app-cs-\u90E8\u5206" tabindex="-1"><a class="header-anchor" href="#_4-app-cs-\u90E8\u5206" aria-hidden="true">#</a> 4. App.cs \u90E8\u5206</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">App</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">readonly</span> <span class="token class-name">ILogger<span class="token punctuation">&lt;</span>App<span class="token punctuation">&gt;</span></span> _logger<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token class-name">ILogger<span class="token punctuation">&lt;</span>App<span class="token punctuation">&gt;</span></span> logger<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _logger <span class="token operator">=</span> logger<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        _logger<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span><span class="token string">&quot;LogInformation&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _logger<span class="token punctuation">.</span><span class="token function">LogWarning</span><span class="token punctuation">(</span><span class="token string">&quot;LogWarning&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-\u7D50\u679C\u7BC4\u4F8B" tabindex="-1"><a class="header-anchor" href="#_5-\u7D50\u679C\u7BC4\u4F8B" aria-hidden="true">#</a> 5. \u7D50\u679C\u7BC4\u4F8B</h2><p>\u6703\u5206\u5225\u8A18\u9304\u70BA\u5169\u500Blog\u6A94:</p><ul><li>INFO.log</li><li>WARN.log</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>2022-10-13 11:55:14.7064|DotNetCoreNLogDI.App|INFO|LogInformation 
2022-10-13 11:55:14.7744|DotNetCoreNLogDI.App|WARN|LogWarning 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="github-repo" tabindex="-1"><a class="header-anchor" href="#github-repo" aria-hidden="true">#</a> Github Repo</h2>`,10),N={href:"https://github.com/samamy888/DotNetCoreNLogDI",target:"_blank",rel:"noopener noreferrer"},x=s("Github Repo \u4F4D\u7F6E"),w=n("h2",{id:"\u53C3\u8003\u8CC7\u6599",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u53C3\u8003\u8CC7\u6599","aria-hidden":"true"},"#"),s(" \u53C3\u8003\u8CC7\u6599")],-1),y={href:"https://github.com/iSatishYadav/net-core-console-nlog-with-di/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"},A=s("https://github.com/iSatishYadav/net-core-console-nlog-with-di/blob/master/README.md");function I(C,D){const a=p("ExternalLinkIcon");return o(),c("div",null,[u,n("p",null,[n("a",r,[k,t(a)]),d]),v,g,m,b,h,n("p",null,[_,n("a",f,[q,t(a)])]),L,n("p",null,[n("a",N,[x,t(a)])]),w,n("p",null,[n("a",y,[A,t(a)])])])}const $=e(i,[["render",I],["__file","2022-10-13-DotNetCoreNLogDI.html.vue"]]);export{$ as default};
